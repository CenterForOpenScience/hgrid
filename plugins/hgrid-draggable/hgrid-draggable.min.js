!function(e,t){"function"==typeof define&&define.amd?define(["jquery","hgrid"],t):"object"==typeof module?module.exports=t(jQuery,HGrid):t(jQuery,HGrid)}(this,function(e,t){return function(e){e.fn.drag=function(t,a,n){var o="string"==typeof t?t:"",i=e.isFunction(t)?t:e.isFunction(a)?a:null;return 0!==o.indexOf("drag")&&(o="drag"+o),n=(t==i?a:n)||{},i?this.bind(o,n,i):this.trigger(o)};var t=e.event,a=t.special,n=a.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(t){var a=e.data(this,n.datakey),o=t.data||{};a.related+=1,e.each(n.defaults,function(e){void 0!==o[e]&&(a[e]=o[e])})},remove:function(){e.data(this,n.datakey).related-=1},setup:function(){if(!e.data(this,n.datakey)){var a=e.extend({related:0},n.defaults);e.data(this,n.datakey,a),t.add(this,"touchstart mousedown",n.init,a),this.attachEvent&&this.attachEvent("ondragstart",n.dontstart)}},teardown:function(){var a=e.data(this,n.datakey)||{};a.related||(e.removeData(this,n.datakey),t.remove(this,"touchstart mousedown",n.init),n.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",n.dontstart))},init:function(o){if(!n.touched){var i,r=o.data;if(!(0!=o.which&&r.which>0&&o.which!=r.which||e(o.target).is(r.not)||r.handle&&!e(o.target).closest(r.handle,o.currentTarget).length||(n.touched="touchstart"==o.type?this:null,r.propagates=1,r.mousedown=this,r.interactions=[n.interaction(this,r)],r.target=o.target,r.pageX=o.pageX,r.pageY=o.pageY,r.dragging=null,i=n.hijack(o,"draginit",r),!r.propagates)))return i=n.flatten(i),i&&i.length&&(r.interactions=[],e.each(i,function(){r.interactions.push(n.interaction(this,r))})),r.propagates=r.interactions.length,r.drop!==!1&&a.drop&&a.drop.handler(o,r),n.textselect(!1),n.touched?t.add(n.touched,"touchmove touchend",n.handler,r):t.add(document,"mousemove mouseup",n.handler,r),!n.touched||r.live?!1:void 0}},interaction:function(t,a){var o=e(t)[a.relative?"position":"offset"]()||{top:0,left:0};return{drag:t,callback:new n.callback,droppable:[],offset:o}},handler:function(o){var i=o.data;switch(o.type){case!i.dragging&&"touchmove":o.preventDefault();case!i.dragging&&"mousemove":if(Math.pow(o.pageX-i.pageX,2)+Math.pow(o.pageY-i.pageY,2)<Math.pow(i.distance,2))break;o.target=i.target,n.hijack(o,"dragstart",i),i.propagates&&(i.dragging=!0);case"touchmove":o.preventDefault();case"mousemove":if(i.dragging){if(n.hijack(o,"drag",i),i.propagates){i.drop!==!1&&a.drop&&a.drop.handler(o,i);break}o.type="mouseup"}case"touchend":case"mouseup":default:n.touched?t.remove(n.touched,"touchmove touchend",n.handler):t.remove(document,"mousemove mouseup",n.handler),i.dragging&&(i.drop!==!1&&a.drop&&a.drop.handler(o,i),n.hijack(o,"dragend",i)),n.textselect(!0),i.click===!1&&i.dragging&&e.data(i.mousedown,"suppress.click",(new Date).getTime()+5),i.dragging=n.touched=!1}},hijack:function(a,o,i,r,d){if(i){var s,c,l,u={event:a.originalEvent,type:a.type},p=o.indexOf("drop")?"drag":"drop",h=r||0,g=isNaN(r)?i.interactions.length:r;a.type=o,a.originalEvent=null,i.results=[];do if(c=i.interactions[h]){if("dragend"!==o&&c.cancelled)continue;l=n.properties(a,i,c),c.results=[],e(d||c[p]||i.droppable).each(function(r,d){return l.target=d,a.isPropagationStopped=function(){return!1},s=d?t.dispatch.call(d,a,l):null,s===!1?("drag"==p&&(c.cancelled=!0,i.propagates-=1),"drop"==o&&(c[p][r]=null)):"dropinit"==o&&c.droppable.push(n.element(s)||d),"dragstart"==o&&(c.proxy=e(n.element(s)||c.drag)[0]),c.results.push(s),delete a.result,"dropinit"!==o?s:void 0}),i.results[h]=n.flatten(c.results),"dropinit"==o&&(c.droppable=n.flatten(c.droppable)),"dragstart"!=o||c.cancelled||l.update()}while(++h<g);return a.type=u.type,a.originalEvent=u.event,n.flatten(i.results)}},properties:function(e,t,a){var o=a.callback;return o.drag=a.drag,o.proxy=a.proxy||a.drag,o.startX=t.pageX,o.startY=t.pageY,o.deltaX=e.pageX-t.pageX,o.deltaY=e.pageY-t.pageY,o.originalX=a.offset.left,o.originalY=a.offset.top,o.offsetX=o.originalX+o.deltaX,o.offsetY=o.originalY+o.deltaY,o.drop=n.flatten((a.drop||[]).slice()),o.available=n.flatten((a.droppable||[]).slice()),o},element:function(e){return e&&(e.jquery||1==e.nodeType)?e:void 0},flatten:function(t){return e.map(t,function(t){return t&&t.jquery?e.makeArray(t):t&&t.length?n.flatten(t):t})},textselect:function(t){e(document)[t?"unbind":"bind"]("selectstart",n.dontstart).css("MozUserSelect",t?"":"none"),document.unselectable=t?"off":"on"},dontstart:function(){return!1},callback:function(){}};n.callback.prototype={update:function(){a.drop&&this.available.length&&e.each(this.available,function(e){a.drop.locate(this,e)})}};var o=t.dispatch;t.dispatch=function(t){return e.data(this,"suppress."+t.type)-(new Date).getTime()>0?void e.removeData(this,"suppress."+t.type):o.apply(this,arguments)};var i=t.fixHooks.touchstart=t.fixHooks.touchmove=t.fixHooks.touchend=t.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(t,a){if(a){var n=a.touches&&a.touches[0]||a.changedTouches&&a.changedTouches[0]||null;n&&e.each(i.props,function(e,a){t[a]=n[a]})}return t}};a.draginit=a.dragstart=a.dragend=n}(jQuery),function(e){e.fn.drop=function(t,a,n){var o="string"==typeof t?t:"",i=e.isFunction(t)?t:e.isFunction(a)?a:null;return 0!==o.indexOf("drop")&&(o="drop"+o),n=(t==i?a:n)||{},i?this.bind(o,n,i):this.trigger(o)},e.drop=function(t){t=t||{},n.multi=t.multi===!0?1/0:t.multi===!1?1:isNaN(t.multi)?n.multi:t.multi,n.delay=t.delay||n.delay,n.tolerance=e.isFunction(t.tolerance)?t.tolerance:null===t.tolerance?null:n.tolerance,n.mode=t.mode||n.mode||"intersect"};var t=e.event,a=t.special,n=e.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:!0,add:function(){var t=e.data(this,n.datakey);t.related+=1},remove:function(){e.data(this,n.datakey).related-=1},setup:function(){if(!e.data(this,n.datakey)){var t={related:0,active:[],anyactive:0,winner:0,location:{}};e.data(this,n.datakey,t),n.targets.push(this)}},teardown:function(){var t=e.data(this,n.datakey)||{};if(!t.related){e.removeData(this,n.datakey);var a=this;n.targets=e.grep(n.targets,function(e){return e!==a})}},handler:function(t,o){var i;if(o)switch(t.type){case"mousedown":case"touchstart":i=e(n.targets),"string"==typeof o.drop&&(i=i.filter(o.drop)),i.each(function(){var t=e.data(this,n.datakey);t.active=[],t.anyactive=0,t.winner=0}),o.droppable=i,a.drag.hijack(t,"dropinit",o);break;case"mousemove":case"touchmove":n.event=t,n.timer||n.tolerate(o);break;case"mouseup":case"touchend":n.timer=clearTimeout(n.timer),o.propagates&&(a.drag.hijack(t,"drop",o),a.drag.hijack(t,"dropend",o))}},locate:function(t,a){var o=e.data(t,n.datakey),i=e(t),r=i.offset()||{},d=i.outerHeight(),s=i.outerWidth(),c={elem:t,width:s,height:d,top:r.top,left:r.left,right:r.left+s,bottom:r.top+d};return o&&(o.location=c,o.index=a,o.elem=t),c},contains:function(e,t){return(t[0]||t.left)>=e.left&&(t[0]||t.right)<=e.right&&(t[1]||t.top)>=e.top&&(t[1]||t.bottom)<=e.bottom},modes:{intersect:function(e,t,a){return this.contains(a,[e.pageX,e.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(e,t,a){return Math.max(0,Math.min(a.bottom,t.bottom)-Math.max(a.top,t.top))*Math.max(0,Math.min(a.right,t.right)-Math.max(a.left,t.left))},fit:function(e,t,a){return this.contains(a,t)?1:0},middle:function(e,t,a){return this.contains(a,[t.left+.5*t.width,t.top+.5*t.height])?1:0}},sort:function(e,t){return t.winner-e.winner||e.index-t.index},tolerate:function(t){var o,i,r,d,s,c,l,u,p=0,h=t.interactions.length,g=[n.event.pageX,n.event.pageY],f=n.tolerance||n.modes[n.mode];do if(u=t.interactions[p]){if(!u)return;u.drop=[],s=[],c=u.droppable.length,f&&(r=n.locate(u.proxy)),o=0;do if(l=u.droppable[o]){if(d=e.data(l,n.datakey),i=d.location,!i)continue;d.winner=f?f.call(n,n.event,r,i):n.contains(i,g)?1:0,s.push(d)}while(++o<c);s.sort(n.sort),o=0;do(d=s[o])&&(d.winner&&u.drop.length<n.multi?(d.active[p]||d.anyactive||(a.drag.hijack(n.event,"dropstart",t,p,d.elem)[0]!==!1?(d.active[p]=1,d.anyactive+=1):d.winner=0),d.winner&&u.drop.push(d.elem)):d.active[p]&&1==d.anyactive&&(a.drag.hijack(n.event,"dropend",t,p,d.elem),d.active[p]=0,d.anyactive-=1));while(++o<c)}while(++p<h);n.last&&g[0]==n.last.pageX&&g[1]==n.last.pageY?delete n.timer:n.timer=setTimeout(function(){n.tolerate(t)},n.delay),n.last=n.event}};a.dropinit=a.dropstart=a.dropend=n}(jQuery),function(e){function t(t){function a(a){t=e.extend(!0,{},h,t),s=a,c=s.getCanvasNode(),p.subscribe(s.onDragInit,o).subscribe(s.onDragStart,i).subscribe(s.onDrag,r).subscribe(s.onDragEnd,d)}function n(){p.unsubscribeAll()}function o(e){e.stopImmediatePropagation()}function i(a,n){var o=s.getCellFromEvent(a);if(t.cancelEditOnDrag&&s.getEditorLock().isActive()&&s.getEditorLock().cancelCurrentEdit(),s.getEditorLock().isActive()||!/move|selectAndMove/.test(s.getColumns()[o.cell].behavior))return!1;l=!0,a.stopImmediatePropagation();var i=s.getSelectedRows();(0==i.length||-1==e.inArray(o.row,i))&&(i=[o.row],s.setSelectedRows(i));var r=s.getOptions().rowHeight;n.selectedRows=i,n.selectionProxy=e("<div class='slick-reorder-proxy'/>").css("position","absolute").css("zIndex","99999").css("width",e(c).innerWidth()).css("height",r*i.length).appendTo(c),n.guide=e("<div class='slick-reorder-guide'/>").css("position","absolute").css("zIndex","99998").css("width",e(c).innerWidth()).css("top",-1e3).appendTo(c),n.insertBefore=-1}function r(t,a){if(l){t.stopImmediatePropagation();var n=t.pageY-e(c).offset().top;a.selectionProxy.css("top",n-5);var o=Math.max(0,Math.min(Math.round(n/s.getOptions().rowHeight),s.getDataLength()));if(o!==a.insertBefore){var i={rows:a.selectedRows,insertBefore:o};u.onBeforeMoveRows.notify(i)===!1?(a.guide.css("top",-1e3),a.canMove=!1):(a.guide.css("top",o*s.getOptions().rowHeight),a.canMove=!0),a.insertBefore=o}}}function d(e,t){if(l&&(l=!1,e.stopImmediatePropagation(),t.guide.remove(),t.selectionProxy.remove(),t.canMove)){var a={rows:t.selectedRows,insertBefore:t.insertBefore};u.onMoveRows.notify(a)}}var s,c,l,u=this,p=new Slick.EventHandler,h={cancelEditOnDrag:!1};e.extend(this,{onBeforeMoveRows:new Slick.Event,onMoveRows:new Slick.Event,init:a,destroy:n})}e.extend(!0,window,{Slick:{RowMoveManager:t}})}(jQuery),function(e,a){"function"==typeof define&&define.amd?define(["jquery","hgrid"],a):"object"==typeof module?module.exports=a(jQuery,t):a(jQuery,t)}(this,function(e,t){function a(t){var a=this;a.options=e.extend({},n,t)}var n={};return a.prototype.init=function(){},t.Draggable=a,a}),Draggable});